-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")

-- Player
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

-- Auto-Join Marines Team
local function joinMarines()
    local teams = game:GetService("Teams")
    local marinesTeam = teams:FindFirstChild("Marines")
    if marinesTeam then
        player.Team = marinesTeam
    end
end
joinMarines()

-- UI Setup
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = player:WaitForChild("PlayerGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0.3, 0, 0.08, 0)
frame.Position = UDim2.new(0.35, 0, 0.01, 0)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.BackgroundTransparency = 0.2
frame.BorderSizePixel = 0
frame.Parent = screenGui
frame.ClipsDescendants = true
frame.ZIndex = 1

local uiCorner = Instance.new("UICorner")
uiCorner.CornerRadius = UDim.new(0.2, 0)
uiCorner.Parent = frame

local fruitLabel = Instance.new("TextLabel")
fruitLabel.Size = UDim2.new(1, 0, 1, 0)
fruitLabel.BackgroundTransparency = 1
fruitLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
fruitLabel.TextScaled = true
fruitLabel.Font = Enum.Font.GothamBold
fruitLabel.TextStrokeTransparency = 0
fruitLabel.TextStrokeColor3 = Color3.fromRGB(50, 50, 50)
fruitLabel.ZIndex = 2
fruitLabel.Parent = frame

-- TP Button
local tpButton = Instance.new("TextButton")
tpButton.Size = UDim2.new(0.1, 0, 0.08, 0)
tpButton.Position = UDim2.new(0.66, 0, 0.01, 0)
tpButton.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
tpButton.Text = "TP"
tpButton.Parent = screenGui

local tpCorner = Instance.new("UICorner")
tpCorner.CornerRadius = UDim.new(0.5, 0)
tpCorner.Parent = tpButton

-- ESP Button
local espButton = Instance.new("TextButton")
espButton.Size = UDim2.new(0.1, 0, 0.08, 0)
espButton.Position = UDim2.new(0.24, 0, 0.01, 0)
espButton.BackgroundColor3 = Color3.fromRGB(100, 255, 100)
espButton.Text = "ESP"
espButton.Parent = screenGui

local espCorner = Instance.new("UICorner")
espCorner.CornerRadius = UDim.new(0.5, 0)
espCorner.Parent = espButton

-- Function to find nearest fruit
local function findNearestFruit()
    local nearestFruit = nil
    local minDistance = math.huge
    for _, fruit in ipairs(Workspace:GetChildren()) do
        if fruit:IsA("Model") and fruit:FindFirstChild("Handle") then
            local distance = (humanoidRootPart.Position - fruit.Handle.Position).Magnitude
            if distance < minDistance then
                minDistance = distance
                nearestFruit = fruit
            end
        end
    end
    return nearestFruit
end

-- TP Function
local teleporting = false
tpButton.MouseButton1Click:Connect(function()
    teleporting = not teleporting
    while teleporting do
        local fruit = findNearestFruit()
        if fruit and fruit:FindFirstChild("Handle") then
            humanoidRootPart.CFrame = fruit.Handle.CFrame * CFrame.new(0, 0, -20)
        else
            teleporting = false
        end
        task.wait(0.11)
    end
end)

-- ESP Function
local function enableESP()
    for _, fruit in ipairs(Workspace:GetChildren()) do
        if fruit:IsA("Model") and fruit:FindFirstChild("Handle") then
            local billboard = Instance.new("BillboardGui")
            billboard.Size = UDim2.new(0, 100, 0, 50)
            billboard.Adornee = fruit.Handle
            billboard.Parent = fruit

            local textLabel = Instance.new("TextLabel")
            textLabel.Size = UDim2.new(1, 0, 1, 0)
            textLabel.BackgroundTransparency = 1
            textLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
            textLabel.TextScaled = true
            textLabel.Text = "Fruit "
            textLabel.Parent = billboard
        end
    end
end
espButton.MouseButton1Click:Connect(enableESP)
